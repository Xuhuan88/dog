<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GO2æœºå™¨äººæ§åˆ¶é¢æ¿</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
        }
        .config-panel {
            background-color: white;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .config-row {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            flex-wrap: wrap;
        }
        .config-label {
            width: 120px;
            font-weight: bold;
        }
        .config-input {
            flex: 1;
            min-width: 300px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin-right: 10px;
        }
        .control-btn {
            padding: 8px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
            transition: all 0.2s;
        }
        .control-btn:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }
        .connect-btn {
            background-color: #4CAF50;
            color: white;
        }
        .disconnect-btn {
            background-color: #f44336;
            color: white;
        }
        .connection-status {
            padding: 8px;
            border-radius: 4px;
            margin-left: 10px;
            font-weight: bold;
        }
        .connected {
            background-color: #4CAF50;
            color: white;
        }
        .disconnected {
            background-color: #f44336;
            color: white;
        }
        .control-section {
            background-color: white;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .section-title {
            font-size: 20px;
            font-weight: bold;
            color: #444;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid #eee;
        }
        .control-panel {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 10px;
        }
        .action-btn {
            background-color: #4CAF50;
            color: white;
        }
        .gait-btn {
            background-color: #2196F3;
            color: white;
        }
        .mode-btn {
            background-color: #9C27B0;
            color: white;
        }
        .advanced-btn {
            background-color: #FF5722;
            color: white;
        }
        .flip-btn {
            background-color: #F44336;
            color: white;
        }
        .dance-btn {
            background-color: #FF9800;
            color: white;
        }
        .move-control {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .move-axis {
            display: flex;
            align-items: center;
        }
        .move-label {
            width: 80px;
            font-weight: bold;
        }
        .move-slider {
            flex: 1;
        }
        .move-value {
            width: 50px;
            text-align: center;
        }
        .active-control {
            box-shadow: 0 0 0 3px #FFC107;
            font-weight: bold;
        }
        .status {
            margin-top: 25px;
            padding: 15px;
            border-radius: 8px;
            background-color: #fff;
            min-height: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            font-family: monospace;
            white-space: pre-wrap;
        }
        .category-title {
            grid-column: 1 / -1;
            font-weight: bold;
            font-size: 16px;
            margin-top: 10px;
            color: #555;
            border-bottom: 1px dashed #ddd;
            padding-bottom: 5px;
        }
        /* æ–°å¢çš„åŸå§‹æŒ‡ä»¤è¾“å…¥æ¡†æ ·å¼ */
        .raw-command-section {
            background-color: white;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .raw-command-input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin-bottom: 10px;
            font-family: monospace;
        }
        .execute-btn {
            background-color: #607D8B;
            color: white;
        }
        /* æ–°å¢çš„è¿æ¥ç±»å‹é€‰æ‹©æ ·å¼ */
        .connection-type-selector {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        .connection-type-label {
            width: 120px;
            font-weight: bold;
        }
        .connection-type-option {
            margin-right: 15px;
        }
        .connection-type-option input {
            margin-right: 5px;
        }
        .dog-ip-input {
            /* ç§»é™¤ display: none */
            flex: 1;
            min-width: 300px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <h1>GO2æœºå™¨äººæ§åˆ¶é¢æ¿</h1>
    
    <!-- æœåŠ¡å™¨é…ç½®é¢æ¿ -->
    <div class="config-panel">
        <div class="section-title">æœåŠ¡å™¨è¿æ¥</div>
        
        <!-- æ–°å¢çš„è¿æ¥ç±»å‹é€‰æ‹© -->
        <div class="connection-type-selector">
            <div class="connection-type-label">è¿æ¥ç±»å‹:</div>
            <div class="connection-type-option">
                <input type="radio" id="ap-connection" name="connection-type" value="ap" checked onchange="toggleConnectionType()">
                <label for="ap-connection">APè¿æ¥</label>
            </div>
            <div class="connection-type-option">
                <input type="radio" id="sta-connection" name="connection-type" value="sta" onchange="toggleConnectionType()">
                <label for="sta-connection">STAè¿æ¥</label>
            </div>
        </div>
        
        <!-- æœºå™¨ç‹—IPè¾“å…¥æ¡† (é»˜è®¤éšè—) -->
        <div class="config-row" id="dog-ip-row">
            <div class="config-label">æœºå™¨ç‹—IP:</div>
            <input type="text" id="dog-ip" class="dog-ip-input" >
        </div>
        
        <div class="config-row">
            <div class="config-label">APIåœ°å€:</div>
            <input type="text" id="api-url" class="config-input" placeholder="http://192.168.1.100:5000">
            <button class="control-btn connect-btn" onclick="connectDog()">è¿æ¥</button>
            <button class="control-btn disconnect-btn" onclick="disconnectDog()">æ–­å¼€</button>
            <div id="connection-status" class="connection-status disconnected">æœªè¿æ¥</div>
        </div>
    </div>
    
    <!-- ç§»åŠ¨æ§åˆ¶åŒº -->
    <div class="control-section">
        <div class="section-title">ç§»åŠ¨æ§åˆ¶</div>
        <div class="move-control">
            <div class="move-axis">
                <div class="move-label">Xè½´(å‰å):</div>
                <input type="range" id="x-axis" class="move-slider" min="-1" max="1" step="0.1" value="0" oninput="updateMoveValue('x')">
                <div id="x-value" class="move-value">0</div>
            </div>
            <div class="move-axis">
                <div class="move-label">Yè½´(å·¦å³):</div>
                <input type="range" id="y-axis" class="move-slider" min="-1" max="1" step="0.1" value="0" oninput="updateMoveValue('y')">
                <div id="y-value" class="move-value">0</div>
            </div>
            <div class="move-axis">
                <div class="move-label">Zè½´(æ—‹è½¬):</div>
                <input type="range" id="z-axis" class="move-slider" min="-1" max="1" step="0.1" value="0" oninput="updateMoveValue('z')">
                <div id="z-value" class="move-value">0</div>
            </div>
            <button class="control-btn" onclick="sendMoveCommand()">å‘é€ç§»åŠ¨æŒ‡ä»¤</button>
            <button class="control-btn" onclick="stopMove()">åœæ­¢ç§»åŠ¨</button>
        </div>
    </div>
    
    <!-- èº«ä½“å…³èŠ‚æ§åˆ¶åŒº -->
    <div class="control-section">
        <div class="section-title">èº«ä½“å…³èŠ‚æ§åˆ¶</div>
        <div class="move-control">
            <div class="move-axis">
                <div class="move-label">Xè½´(æ»šè½¬è§’):</div>
                <input type="range" id="euler-x" class="move-slider" min="-1" max="1" step="0.1" value="0" oninput="updateEulerValue('x')">
                <div id="euler-x-value" class="move-value">0</div>
            </div>
            <div class="move-axis">
                <div class="move-label">Yè½´(ä¿¯ä»°è§’):</div>
                <input type="range" id="euler-y" class="move-slider" min="-1" max="1" step="0.1"  value="0" oninput="updateEulerValue('y')">
                <div id="euler-y-value" class="move-value">0</div>
            </div>
            <div class="move-axis">
                <div class="move-label">Zè½´(åèˆªè§’):</div>
                <input type="range" id="euler-z" class="move-slider" min="-1" max="1" step="0.1" value="0" oninput="updateEulerValue('z')">
                <div id="euler-z-value" class="move-value">0</div>
            </div>
            <button class="control-btn" onclick="sendEulerCommand()">å‘é€å…³èŠ‚æŒ‡ä»¤</button>
            <button class="control-btn" onclick="resetEuler()">é‡ç½®å…³èŠ‚</button>
        </div>
    </div>
    
    <!-- æ¨¡å¼æ§åˆ¶åŒº -->
    <div class="control-section">
        <div class="section-title">æ¨¡å¼åˆ‡æ¢</div>
        <div class="control-panel">
            <button class="control-btn mode-btn" id="normal-mode" onclick="switchMotion('normal')">æ™®é€šæ¨¡å¼</button>
            <button class="control-btn mode-btn" id="ai-mode" onclick="switchMotion('ai')">AIæ¨¡å¼</button>
            <button class="control-btn advanced-btn" id="advanced-mode" onclick="switchMotion('advanced')">é«˜çº§æ¨¡å¼</button>
        </div>
    </div>
    
    <!-- åŠ¨ä½œæ§åˆ¶åŒº -->
    <div class="control-section">
        <div class="section-title">åŠ¨ä½œæ§åˆ¶</div>
        <div class="control-panel">
            <div class="category-title">åŸºæœ¬åŠ¨ä½œ</div>
            <button class="control-btn action-btn" onclick="sendAction(1001)">é˜»å°¼æ¨¡å¼</button>
            <button class="control-btn action-btn" onclick="sendAction(1002)">å¹³è¡¡ç«™ç«‹</button>
            <button class="control-btn action-btn" onclick="sendAction(1003)">åœæ­¢ç§»åŠ¨</button>
            <button class="control-btn action-btn" onclick="sendAction(1004)">ç«™ç«‹èµ·èº«</button>
            <button class="control-btn action-btn" onclick="sendAction(1005)">ç«™ç«‹ä¸‹è¹²</button>
            <button class="control-btn action-btn" onclick="sendAction(1006)">æ¢å¤ç«™ç«‹</button>
            <button class="control-btn action-btn" onclick="sendAction(1009)">åä¸‹</button>
            <button class="control-btn action-btn" onclick="sendAction(1010)">ä»åå§¿ç«™èµ·</button>

            <div class="category-title">æ­¥æ€æ§åˆ¶</div>
            <button class="control-btn gait-btn" onclick="sendAction(1061)">ç»å…¸æ­¥æ€</button>
            <button class="control-btn gait-btn" onclick="sendAction(1062)">è·‘æ­¥æ­¥æ€</button>
            <button class="control-btn gait-btn" onclick="sendAction(1063)">å¸¸è§„æ­¥æ€</button>
            <button class="control-btn gait-btn" onclick="sendAction(2049)">çµåŠ¨æ­¥æ€</button>

            <div class="category-title">äº’åŠ¨åŠ¨ä½œ</div>
            <button class="control-btn action-btn" onclick="sendAction(1016)">æ‰“æ‹›å‘¼</button>
            <button class="control-btn action-btn" onclick="sendAction(1017)">ä¼¸å±•åŠ¨ä½œ</button>
            <button class="control-btn action-btn" onclick="sendAction(1036)">æ‰‹æŒ‡æ¯”å¿ƒ</button>
            <button class="control-btn flip-btn" onclick="sendAction(1031)">å‰è·³</button>
            <button class="control-btn flip-btn" onclick="sendAction(1032)">å‰æ‰‘</button>
            <button class="control-btn action-btn" onclick="sendAction(1029)">æ‹œå¹´</button>

            <div class="category-title">èˆè¹ˆåŠ¨ä½œ</div>
            <button class="control-btn dance-btn" onclick="sendAction(1022)">èˆè¹ˆåŠ¨ä½œ1</button>
            <button class="control-btn dance-btn" onclick="sendAction(1023)">èˆè¹ˆåŠ¨ä½œ2</button>

            <div class="category-title">ç¿»è½¬åŠ¨ä½œ</div>
            <button class="control-btn flip-btn" onclick="sendAction(1030)">å‰ç©ºç¿»</button>
            <button class="control-btn flip-btn" onclick="sendAction(2041)">å·¦ä¾§ç¿»</button>
            <button class="control-btn flip-btn" onclick="sendAction(2043)">åç©ºç¿»</button>

            <div class="category-title">é«˜éš¾åº¦åŠ¨ä½œ</div>
            <button class="control-btn action-btn" onclick="sendAction(2051)">äº¤å‰æ­¥</button>
            <button class="control-btn action-btn" onclick="sendAction(2044)">å€’ç«‹</button>
            <button class="control-btn action-btn" onclick="sendAction(2050)">åè…¿ç«™ç«‹</button>
        </div>
    </div>
    
    <div class="status" id="status">
â–¶ ç³»ç»Ÿå°±ç»ªï¼Œç­‰å¾…æŒ‡ä»¤...
    </div>
    
    <script>
        // é…ç½®å’ŒçŠ¶æ€
        let config = {
            apiUrl: localStorage.getItem('go2_api_url') || 'http://127.0.0.1:5000',
            connected: false,
            connectionType: localStorage.getItem('go2_connection_type') || 'ap',
            dogIp: localStorage.getItem('go2_dog_ip') || ''
        };
        
        // åŠ¨ä½œæ˜ å°„è¡¨ï¼ˆä»…ç”¨äºæ˜¾ç¤ºï¼‰
        const ACTION_MAP = {
            1001: "é˜»å°¼æ¨¡å¼",
            1002: "å¹³è¡¡ç«™ç«‹",
            1003: "åœæ­¢ç§»åŠ¨",
            1004: "ç«™ç«‹èµ·èº«",
            1005: "ç«™ç«‹ä¸‹è¹²",
            1006: "æ¢å¤ç«™ç«‹",
            1009: "åä¸‹",
            1010: "ä»åå§¿ç«™èµ·",
            1016: "æ‰“æ‹›å‘¼",
            1017: "ä¼¸å±•åŠ¨ä½œ",
            1022: "èˆè¹ˆåŠ¨ä½œ1",
            1023: "èˆè¹ˆåŠ¨ä½œ2",
            1030: "å‰ç©ºç¿»",
            2041: "å·¦ä¾§ç¿»",
            2043: "åç©ºç¿»",
            1031: "å‰è·³",
            1032: "å‰æ‰‘",
            1036: "æ‰‹æŒ‡æ¯”å¿ƒ",
            1061: "ç»å…¸æ­¥æ€",
            1062: "è·‘æ­¥æ­¥æ€",
            1063: "å¸¸è§„æ­¥æ€",
            2049: "çµåŠ¨æ­¥æ€",
            2044: "å€’ç«‹",
            2050: "åè…¿ç«™ç«‹",
            2051: "äº¤å‰æ­¥",
            1029: "æ‹œå¹´"
        };
        
        // æ­¥æ€æ˜ å°„è¡¨ï¼ˆä»…ç”¨äºæ˜¾ç¤ºï¼‰
        const GAIT_MAP = {
            1061: "ç»å…¸æ­¥æ€",
            1062: "è·‘æ­¥æ­¥æ€",
            1063: "å¸¸è§„æ­¥æ€",
            2049: "çµåŠ¨æ­¥æ€"
        };
        
        // ä¿®æ­£åçš„æ¨¡å¼æ˜ å°„è¡¨ï¼ˆç¡®ä¿ä¸åç«¯ä¸€è‡´ï¼‰
        const MODE_MAP = {
            "normal": "æ™®é€šæ¨¡å¼", 
            "ai": "AIæ¨¡å¼",
            "advanced": "é«˜çº§æ¨¡å¼"
        };
        
        // åˆå§‹åŒ–é¡µé¢
        function initPage() {
            document.getElementById('api-url').value = config.apiUrl;
            document.getElementById('dog-ip').value = config.dogIp;
            
            // è®¾ç½®è¿æ¥ç±»å‹å•é€‰æŒ‰é’®
            if (config.connectionType === 'ap') {
                document.getElementById('ap-connection').checked = true;
            } else {
                document.getElementById('sta-connection').checked = true;
            }
            
            // æ ¹æ®è¿æ¥ç±»å‹æ˜¾ç¤º/éšè—IPè¾“å…¥æ¡†
            toggleConnectionType();
            updateConnectionStatus();
        }
        
        // åˆ‡æ¢è¿æ¥ç±»å‹æ˜¾ç¤º
        function toggleConnectionType() {
            const connectionType = document.querySelector('input[name="connection-type"]:checked').value;
            const dogIpRow = document.getElementById('dog-ip-row');
            
            if (connectionType === 'sta') {
                dogIpRow.style.display = 'flex';
            } else {
                dogIpRow.style.display = 'none';
            }
        }
        
        // æ›´æ–°è¿æ¥çŠ¶æ€æ˜¾ç¤º
        function updateConnectionStatus() {
            const statusElement = document.getElementById('connection-status');
            if (config.connected) {
                statusElement.textContent = "å·²è¿æ¥";
                statusElement.className = "connection-status connected";
            } else {
                statusElement.textContent = "æœªè¿æ¥";
                statusElement.className = "connection-status disconnected";
            }
        }
        
        // è¿æ¥æœºå™¨äºº
        async function connectDog() {
            const apiUrl = document.getElementById('api-url').value.trim();
            if (!apiUrl) {
                updateStatus("âŒ è¯·è¾“å…¥æœ‰æ•ˆçš„APIåœ°å€");
                return;
            }
            
            config.apiUrl = apiUrl;
            localStorage.setItem('go2_api_url', apiUrl);
            
            // è·å–è¿æ¥ç±»å‹å’Œæœºå™¨ç‹—IP
            const connectionType = document.querySelector('input[name="connection-type"]:checked').value;
            config.connectionType = connectionType;
            localStorage.setItem('go2_connection_type', connectionType);
            
            let dogIp = '';
            if (connectionType === 'sta') {
                
                dogIp = document.getElementById('dog-ip').value.trim();
                if (!dogIp) {
                    updateStatus("âŒ è¯·è¾“å…¥æœºå™¨ç‹—IPåœ°å€");
                    return;
                }
                config.dogIp = dogIp;
                localStorage.setItem('go2_dog_ip', dogIp);
            }
            
            try {
                updateStatus("ğŸ”„ æ­£åœ¨è¿æ¥æœºå™¨äºº...");
                
                // æ„å»ºè¯·æ±‚ä½“
                const requestBody = {
                    robot_ip:""
                };
                
                // å¦‚æœæ˜¯STAæ¨¡å¼ï¼Œæ·»åŠ æœºå™¨ç‹—IP
                if (connectionType === 'sta') {
                    requestBody.robot_ip = dogIp;
                }
                
                const response = await fetch(`${config.apiUrl}/api/connect`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(requestBody)
                });
                
                const data = await response.json();
                if (response.ok && data.status === "success") {
                    config.connected = true;
                    updateStatus(`âœ… ${data.message}`);
                } else {
                    updateStatus(`âŒ è¿æ¥å¤±è´¥: ${data.message || response.status}`);
                }
            } catch (error) {
                updateStatus(`âš ï¸ è¿æ¥å‡ºé”™: ${error.message}`);
            } finally {
                updateConnectionStatus();
            }
        }
        
        // æ–­å¼€æœºå™¨äººè¿æ¥
        async function disconnectDog() {
            try {
                updateStatus("ğŸ”„ æ­£åœ¨æ–­å¼€è¿æ¥...");
                const response = await fetch(`${config.apiUrl}/api/disconnect`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    }
                });
                
                const data = await response.json();
                if (response.ok && data.status === "success") {
                    config.connected = false;
                    updateStatus(`âœ… ${data.message}`);
                } else {
                    updateStatus(`âŒ æ–­å¼€è¿æ¥å¤±è´¥: ${data.message || response.status}`);
                }
            } catch (error) {
                updateStatus(`âš ï¸ æ–­å¼€è¿æ¥å‡ºé”™: ${error.message}`);
            } finally {
                updateConnectionStatus();
            }
        }
        
        // å‘é€åŠ¨ä½œæŒ‡ä»¤ï¼ˆç°åœ¨åªä¼ é€’æœºå™¨ç ï¼‰
        async function sendAction(actionCode) {
            if (!checkConnection()) return;
            
            try {
                updateStatus(`ğŸ”„ æ­£åœ¨å‘é€åŠ¨ä½œæŒ‡ä»¤: ${ACTION_MAP[actionCode] || actionCode}`);
                const response = await fetch(`${config.apiUrl}/api/action`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        action_code: actionCode
                    })
                });
                
                const data = await response.json();
                if (response.ok && data.status === "success") {
                    updateStatus(`âœ… åŠ¨ä½œæ‰§è¡ŒæˆåŠŸ: ${data.message}`);
                } else {
                    updateStatus(`âŒ åŠ¨ä½œæ‰§è¡Œå¤±è´¥: ${data.message || response.status}`);
                }
            } catch (error) {
                updateStatus(`âš ï¸ å‘é€åŠ¨ä½œæŒ‡ä»¤å‡ºé”™: ${error.message}`);
            }
        }
        
        // åˆ‡æ¢æ¨¡å¼ï¼ˆä¿®æ­£å‚æ•°ä¼ é€’ï¼‰
        async function switchMotion(motion) {
            if (!checkConnection()) return;
            
            try {
                updateStatus(`ğŸ”„ æ­£åœ¨åˆ‡æ¢æ¨¡å¼: ${MODE_MAP[motion] || motion}`);
                const response = await fetch(`${config.apiUrl}/api/switchMotion`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        motion: motion  // ç›´æ¥ä½¿ç”¨å‚æ•°å€¼ï¼Œç¡®ä¿ä¸åç«¯ä¸€è‡´
                    })
                });
                
                const data = await response.json();
                if (response.ok && data.status === "success") {
                    updateStatus(`âœ… æ¨¡å¼åˆ‡æ¢æˆåŠŸ: ${data.message}`);
                    // æ›´æ–°æ‰€æœ‰æ¨¡å¼æŒ‰é’®çŠ¶æ€
                    document.getElementById('normal-mode').classList.toggle('active-control', motion === 'normal');
                    document.getElementById('ai-mode').classList.toggle('active-control', motion === 'ai');
                    document.getElementById('advanced-mode').classList.toggle('active-control', motion === 'advanced');
                } else {
                    updateStatus(`âŒ æ¨¡å¼åˆ‡æ¢å¤±è´¥: ${data.message || response.status}`);
                }
            } catch (error) {
                updateStatus(`âš ï¸ åˆ‡æ¢æ¨¡å¼å‡ºé”™: ${error.message}`);
            }
        }
        
        // æ›´æ–°ç§»åŠ¨æ»‘å—å€¼æ˜¾ç¤º
        function updateMoveValue(axis) {
            const value = document.getElementById(`${axis}-axis`).value;
            document.getElementById(`${axis}-value`).textContent = value;
        }
        
        // å‘é€ç§»åŠ¨æŒ‡ä»¤
        async function sendMoveCommand() {
            if (!checkConnection()) return;
            
            const x = parseFloat(document.getElementById('x-axis').value);
            const y = parseFloat(document.getElementById('y-axis').value);
            const z = parseFloat(document.getElementById('z-axis').value);
            
            try {
                updateStatus(`ğŸ”„ æ­£åœ¨å‘é€ç§»åŠ¨æŒ‡ä»¤: X=${x}, Y=${y}, Z=${z}`);
                const response = await fetch(`${config.apiUrl}/api/move`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        x: x,
                        y: y,
                        z: z
                    })
                });
                
                const data = await response.json();
                if (response.ok && data.status === "success") {
                    updateStatus(`âœ… ç§»åŠ¨æŒ‡ä»¤æ‰§è¡ŒæˆåŠŸ: ${data.message}`);
                } else {
                    updateStatus(`âŒ ç§»åŠ¨æŒ‡ä»¤æ‰§è¡Œå¤±è´¥: ${data.message || response.status}`);
                }
            } catch (error) {
                updateStatus(`âš ï¸ å‘é€ç§»åŠ¨æŒ‡ä»¤å‡ºé”™: ${error.message}`);
            }
        }
        
        // åœæ­¢ç§»åŠ¨
        async function stopMove() {
            if (!checkConnection()) return;
            
            try {
                updateStatus("ğŸ”„ æ­£åœ¨å‘é€åœæ­¢ç§»åŠ¨æŒ‡ä»¤...");
                const response = await fetch(`${config.apiUrl}/api/move`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        x: 0,
                        y: 0,
                        z: 0
                    })
                });
                
                const data = await response.json();
                if (response.ok && data.status === "success") {
                    // é‡ç½®æ»‘å—
                    document.getElementById('x-axis').value = 0;
                    document.getElementById('y-axis').value = 0;
                    document.getElementById('z-axis').value = 0;
                    document.getElementById('x-value').textContent = '0';
                    document.getElementById('y-value').textContent = '0';
                    document.getElementById('z-value').textContent = '0';
                    
                    updateStatus(`âœ… åœæ­¢ç§»åŠ¨æˆåŠŸ: ${data.message}`);
                } else {
                    updateStatus(`âŒ åœæ­¢ç§»åŠ¨å¤±è´¥: ${data.message || response.status}`);
                }
            } catch (error) {
                updateStatus(`âš ï¸ åœæ­¢ç§»åŠ¨å‡ºé”™: ${error.message}`);
            }
        }
        
        // æ›´æ–°å…³èŠ‚æ»‘å—å€¼æ˜¾ç¤º
        function updateEulerValue(axis) {
            const value = document.getElementById(`euler-${axis}`).value;
            document.getElementById(`euler-${axis}-value`).textContent = value;
        }
        
        // å‘é€å…³èŠ‚æ§åˆ¶æŒ‡ä»¤
        async function sendEulerCommand() {
            if (!checkConnection()) return;
            
            const x = parseFloat(document.getElementById('euler-x').value);
            const y = parseFloat(document.getElementById('euler-y').value);
            const z = parseFloat(document.getElementById('euler-z').value);
            
            try {
                updateStatus(`ğŸ”„ æ­£åœ¨å‘é€å…³èŠ‚æŒ‡ä»¤: X=${x}, Y=${y}, Z=${z}`);
                const response = await fetch(`${config.apiUrl}/api/euler`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        x: x,
                        y: y,
                        z: z
                    })
                });
                
                const data = await response.json();
                if (response.ok && data.status === "success") {
                    updateStatus(`âœ… å…³èŠ‚æŒ‡ä»¤æ‰§è¡ŒæˆåŠŸ: ${data.message}`);
                } else {
                    updateStatus(`âŒ å…³èŠ‚æŒ‡ä»¤æ‰§è¡Œå¤±è´¥: ${data.message || response.status}`);
                }
            } catch (error) {
                updateStatus(`âš ï¸ å‘é€å…³èŠ‚æŒ‡ä»¤å‡ºé”™: ${error.message}`);
            }
        }
        
        // é‡ç½®å…³èŠ‚ä½ç½®
        function resetEuler() {
            document.getElementById('euler-x').value = 0;
            document.getElementById('euler-y').value = 0;
            document.getElementById('euler-z').value = 0;
            document.getElementById('euler-x-value').textContent = '0';
            document.getElementById('euler-y-value').textContent = '0';
            document.getElementById('euler-z-value').textContent = '0';
            sendEulerCommand();
        }
        
        // æ£€æŸ¥è¿æ¥çŠ¶æ€
        function checkConnection() {
            if (!config.connected) {
                updateStatus("âš ï¸ è¯·å…ˆè¿æ¥æœºå™¨äºº");
                return false;
            }
            return true;
        }
        
        // æ›´æ–°çŠ¶æ€æ˜¾ç¤º
        function updateStatus(message) {
            const now = new Date().toLocaleTimeString();
            document.getElementById('status').innerHTML = `[${now}] ${message}`;
        }
        
        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        window.onload = initPage;
    </script>
</body>
</html>